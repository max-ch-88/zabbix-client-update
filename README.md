Zabbix agent config updater.  
Подсистема предназначена для автообновления скриптов и настроек агентов из централизованного хранилища.  
Агент отправляет url-запрос с именем хоста на сервер. Сервер возвращает md5 набора файлов для этого хоста.  
Если полученный md5 отличается от локального, удаляются все файлы из /etc/zabbix, скачиваются все файлы с сервера и агент перезапускается.  
Для удаления, скачивания и рестарта нужны дополнительные полномочия для пользователя zabbix (см. /etc/sudoers.d).  
В качестве хранилища может использоваться любой веб-сервер с авторизацией. В /etc/nginx пример на nginx.  
  
Хранилище это набор каталогов, доступный веб-серверу, вида:  
  
├─ .repo                                            каталог с оригинальными файлами  
│  ├─ scripts                                           подкаталог с файлами скриптов  
│  └─ zabbix_agentd.d                                   подкаталог с файлами конфигураций  
├─ <hostname as configured on the zabbix server>    каталог для хоста  
│  ├─ scripts                                           подкаталог со ссылками на оригиналы скриптов в .repo\scripts  
│  └─ zabbix_agentd.d                                   подкаталог со ссылками на оригиналы конфигураций в .repo\zabbix_agentd.d  
├─ <hostname as configured on the zabbix server>    каталог для хоста  
│  ├─ scripts                                           подкаталог со ссылками на оригиналы скриптов в .repo\scripts  
│  └─ zabbix_agentd.d                                   подкаталог со ссылками на оригиналы конфигураций в .repo\zabbix_agentd.d  
├─ <...>  
│  ├─ scripts  
│  └─ zabbix_agentd.d  
├─ .zbx-cfg-md5.php                                 страница, принимающая запрос от хоста  
└─ .zbx_cfg_md5.sh                                  сценарий, определяющий MD5 набора файлов  
  
На стороне клиента необходим wget и zabbix-agent. На хост скопировать каталоги /etc/sudoers.d и /etc/zabbix.  
На сервере Zabbix импортировать шаблон Template_App_Zabbix_Agent_config_updater.xml. Привязать шаблон к нужным хостам.  
  

